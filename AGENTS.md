# AGENTS.md — правила для Codex / ИИ‑агентов

Репозиторий: `skillra_hse_pda`  
Контекст: учебный проект по Python для анализа данных + фундамент продукта Career & Job Market Navigator (Skillra).

---

## 1. Главный источник правды

1. Всегда ориентируйся на два файла:
   - `CODEx_PLAN.md` — общая цель, архитектура и правила.
   - `CODEx_DIFF_PLAN.md` — актуальный дифф‑план задач.

2. Если инструкции в истории коммитов, старых файлов или старых планов противоречат этим двум файлам или явным сообщениям пользователя — приоритет у:
   1) свежих инструкций пользователя в чате,  
   2) затем у `CODEx_DIFF_PLAN.md`,  
   3) затем у `CODEx_PLAN.md`.

---

## 2. Жёсткие ограничения

1. **Не изменяй** содержимое `data/raw/*` (особенно `hh_moscow_it_2025_11_30.csv`). Это источник истины.
2. Все новые таблицы сохраняй в `data/processed/`.
3. Все графики сохраняй в `reports/figures/`.
4. Не добавляй в репозиторий тяжёлые бинарники (кроме данных/ноутбуков), не скачивай ничего с интернета.
5. Поддерживай совместимость с Python 3.11+.

---

## 3. Ноутбуки и скрипты

1. `notebooks/01_hse_project.ipynb` — главный учебный ноутбук. После любых изменений он должен выполняться **Run All** без ошибок.
2. Все вычисления и логика должны по максимуму жить в `src/skillra_pda/*.py`. В ноутбуке — только вызовы и выводы.
3. Скрипты:
   - `scripts/validate_pipeline.py` — быстрый регрессионный тест пайплайна.
   - `scripts/run_pipeline.py` — общий пайплайн (если создан в рамках задач).

После доработок оба скрипта должны успешно выполняться из корня репозитория.

---

## 4. Код и архитектура

1. Основной пакет: `src/skillra_pda/`. Не создавай новые пакеты без необходимости.
2. Если добавляешь новые функции/классы:
   - давай им понятные имена,
   - пиши docstring (кратко, что делает, вход/выход),
   - по возможности добавляй простые тесты в `tests/`.
3. Не удаляй существующие публичные функции без явной просьбы пользователя. Если нужно поменять поведение — либо расширяй, либо делай обёртки.
4. Если меняешь сигнатуры, обязательно:
   - обнови вызовы в `notebooks/`, `scripts/`,
   - при необходимости — документацию в `docs/`.

---

## 5. Документация

1. При добавлении новых признаков или важных функций:
   - обновляй `docs/02_feature_dictionary_hh.md` (описание признаков),
   - при необходимости — `docs/00_assignment_TZ.md`, `docs/01_product_context_skillra.md`, `README.md`.
2. Markdown‑файлы — это спецификация. Не игнорируй их и не противоречь им без явной причины.

---

Если пользователь в чате явно просит сделать что‑то, что противоречит этим правилам — уточняй и следуй прямым указаниям пользователя.
